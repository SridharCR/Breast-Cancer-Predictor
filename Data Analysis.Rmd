---
title: "Data Analysis"
author: "Sridhar"
date: "28 January 2019"
output: html_document
---

```{r}
#install.packages("ggplot2")
#install.packages("ggvis")
#install.packages("mice")
library(ggplot2)
library(ggvis)
```
## Load the Data
Breast Cancer Wisconsin(Diagnosis) data is loaded and the column names are defined based on the attribute information.

### Dataset 1
The outcome variable is the "classes" and it has following category of data
* Malignant or
* Benign breast mass
The phenotypes for characterization are
* Sample ID (code number)
* Clump thickness
* Uniformity of cell size
* Uniformity of cell shape
* Marginal adhesion
* Single epithelial cell size
* Number of bare nuclei
* Bland chromatin
* Number of normal nuclei
* Mitosis
* Classes, i.e. diagnosis


```{r}
diagnosis_data <- read.csv("breast-cancer-wisconsin.data.csv", header = FALSE)
colnames(diagnosis_data) <- c("sample_code_number", "clump_thickness", "uniformity_of_cell_size", "uniformity_of_cell_shape", "marginal_adhesion", "single_epithelial_cell_size", 
                       "bare_nuclei", "bland_chromatin", "normal_nucleoli", "mitosis", "classes")

```


```{r}
# impute missing data
library(mice)

diagnosis_data[,2:10] <- apply(diagnosis_data[, 2:10], 2, function(x) as.numeric(as.character(x)))
dataset_impute <- mice(diagnosis_data[, 2:10],  print = FALSE)
diagnosis_data <- cbind(diagnosis_data[, 11, drop = FALSE], mice::complete(dataset_impute, 1))

diagnosis_data$classes <- as.factor(diagnosis_data$classes)

# how many benign and malignant cases are there?
summary(diagnosis_data$classes)
```
The data is presented below.


```{r}
head(diagnosis_data)
```

The properties of data are given,

```{r}
str(diagnosis_data)
```

### Dataset 2
The outcome variable is the "classes" and it has following category of data
Attribute Information:

1) ID number 
2) Diagnosis (M = malignant, B = benign) 
3-32) 

Ten real-valued features are computed for each cell nucleus: 

a) radius (mean of distances from center to points on the perimeter) 
b) texture (standard deviation of gray-scale values) 
c) perimeter 
d) area 
e) smoothness (local variation in radius lengths) 
f) compactness (perimeter^2 / area - 1.0) 
g) concavity (severity of concave portions of the contour) 
h) concave points (number of concave portions of the contour) 
i) symmetry 
j) fractal dimension ("coastline approximation" - 1)

```{r}
diagnosis_data_2 <- read.csv("wdbc.data.csv", header = FALSE)

phenotypes <- rep(c("radius", "texture", "perimeter", "area", "smoothness", "compactness", "concavity", "concave_points", "symmetry", "fractal_dimension"), 3)
types <- rep(c("mean", "se", "largest_worst"), each = 10)

colnames(diagnosis_data_2) <- c("ID", "diagnosis", paste(phenotypes, types, sep = "_"))
head(diagnosis_data_2)

```

```{r}
str(diagnosis_data_2)
```

```{r}
diagnosis_data_3 <- read.csv("wpbc.data.csv", header = FALSE)

colnames(diagnosis_data_3) <- c("ID", "outcome", "time", paste(phenotypes, types, sep = "_"), "tumor_size", "lymph_node_status")
diagnosis_data_3[diagnosis_data_3 == "?"] <- NA
head(diagnosis_data_3)

```

## Visualizations

```{r}
# plotting theme


my_theme <- function(base_size = 12, base_family = "sans"){
  theme_minimal(base_size = base_size, base_family = base_family) +
  theme(
    axis.text = element_text(size = 12),
    axis.text.x = element_text(angle = 0, vjust = 0.5, hjust = 0.5),
    axis.title = element_text(size = 14),
    panel.grid.major = element_line(color = "grey"),
    panel.grid.minor = element_blank(),
    panel.background = element_rect(fill = "aliceblue"),
    strip.background = element_rect(fill = "navy", color = "navy", size = 1),
    strip.text = element_text(face = "bold", size = 12, color = "white"),
    legend.position = "right",
    legend.justification = "top", 
    legend.background = element_blank(),
    panel.border = element_rect(color = "grey", fill = NA, size = 0.5)
  )
}

theme_set(my_theme())
```



```{r}
samplesize = 0.60 * nrow(diagnosis_data)
set.seed(80)
index = sample( seq_len ( nrow ( diagnosis_data ) ), size = samplesize )

# Create training and test set
datatrain = diagnosis_data[ index, ]
datatest = diagnosis_data[ -index, ]
```

```{r}
max = apply(diagnosis_data , 2 , max)
min = apply(diagnosis_data, 2 , min)
scaled = as.data.frame(scale(diagnosis_data, center = min, scale = max - min))
```

